#!/bin/bash
#Adjust these export commands to meet your directory settings
export PlotPath=
export ArtusInput=
export Masses=
export Weights=
export Paralells=
export scale_mc='1.0'
export project_lumi='1.0'
export cut_mc='1.0'
export Variable=m_vis

#=====BDT plotting commands start here=====
mkdir -p $PlotPath/BDTs
rm $PlotPath/BDTs/em/em_minmax.txt
touch $PlotPath/BDTs/em/em_minmax.txt

#============plotlevel operations=============


#=====Cuts and Uncertainties=====

python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py --mva -i $ArtusInput -a '--legend 0.23 0.63 0.9 0.83 --formats png eps pdf --y-rel-lims 0.9 1.75 --y-subplot-lims 0.5 1.5 --x-bins "40,-1,1" --filename "ratio_em_OneJets_FakeBDT"' -s ztt zll ttj vv wj qcd ggh qqh vh htt data -m $Masses  -r --blinding-threshold 0.2 -c em -w $Weights --scale-signal 250 -o $PlotPath/BDTs/em/em_OneJets_FakeBDT -n $Paralells -x em_OneJets_FakeBDT --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc
python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py --mva -i $ArtusInput -a '--legend 0.23 0.63 0.9 0.83 --formats png eps pdf --y-rel-lims 0.9 1.75 --x-bins "400,-1,1" --filename "integral_em_OneJets_FakeBDT" --sob-frontname "regular_name : "' -s ztt zll ttj vv wj qcd ggh qqh vh htt -m $Masses  --integrated-sob --integration-directions 'righttoleft' 'righttoleft' 'righttoleft' 'rcombination' --integration-methods soversqrtsplusb --integration-output $PlotPath/BDTs/em/em_minmax.txt -c em -w $Weights --blinding-threshold 0.15 --scale-signal 250 -o $PlotPath/BDTs/em/em_OneJets_FakeBDT -n $Paralells -x em_OneJets_FakeBDT --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc
#=====copy files with new categories=====
cp $PlotPath/BDTs/em/em_minmax.txt $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/data/mva_configs/em_expressions.cfg
cp ./em_mvadatacards.cfg $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/data/mva_configs/em_mvadatacards.cfg

python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py --mva -i $ArtusInput -a '--legend 0.23 0.63 0.9 0.83 --formats png eps pdf --y-rel-lims 0.9 1.75 --y-subplot-lims 0.5 1.5 --x-bins "40,-1,1" --filename "ratio_em_OneJets_FinalBDT"' -s ztt zll ttj vv wj qcd ggh qqh vh htt data -m $Masses  -r --blinding-threshold 0.2 -c em -w $Weights --scale-signal 250 -o $PlotPath/BDTs/em/em_OneJets_FinalBDT -n $Paralells -x em_OneJets_FinalBDT --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc
python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py --mva -i $ArtusInput -a '--legend 0.23 0.63 0.9 0.83 --formats png eps pdf --y-rel-lims 0.9 1.75 --x-bins "400,-1,1" --filename "integral_em_OneJets_FinalBDT" --sob-frontname "regular_name : "' -s ztt zll ttj vv wj qcd ggh qqh vh htt -m $Masses  --integrated-sob --integration-directions 'righttoleft' 'righttoleft' 'righttoleft' 'rcombination' --integration-methods soversqrtsplusb --integration-output $PlotPath/BDTs/em/em_minmax.txt -c em -w $Weights --blinding-threshold 0.15 --scale-signal 250 -o $PlotPath/BDTs/em/em_OneJets_FinalBDT -n $Paralells -x em_OneJets_FinalBDT --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc
#=====copy files with new categories=====
cp $PlotPath/BDTs/em/em_minmax.txt $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/data/mva_configs/em_expressions.cfg
cp ./em_mvadatacards.cfg $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/data/mva_configs/em_mvadatacards.cfg

python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py --mva -i $ArtusInput -a '--legend 0.23 0.63 0.9 0.83 --formats png eps pdf --y-rel-lims 0.9 1.75 --y-subplot-lims 0.5 1.5 --x-bins "40,-1,1" --filename "ratio_em_OneJets_ZttBDT"' -s ztt zll ttj vv wj qcd ggh qqh vh htt data -m $Masses  -r --blinding-threshold 0.2 -c em -w $Weights --scale-signal 250 -o $PlotPath/BDTs/em/em_OneJets_ZttBDT -n $Paralells -x em_OneJets_ZttBDT --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc
python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py --mva -i $ArtusInput -a '--legend 0.23 0.63 0.9 0.83 --formats png eps pdf --y-rel-lims 0.9 1.75 --x-bins "400,-1,1" --filename "integral_em_OneJets_ZttBDT" --sob-frontname "regular_name : "' -s ztt zll ttj vv wj qcd ggh qqh vh htt -m $Masses  --integrated-sob --integration-directions 'righttoleft' 'righttoleft' 'righttoleft' 'rcombination' --integration-methods soversqrtsplusb --integration-output $PlotPath/BDTs/em/em_minmax.txt -c em -w $Weights --blinding-threshold 0.15 --scale-signal 250 -o $PlotPath/BDTs/em/em_OneJets_ZttBDT -n $Paralells -x em_OneJets_ZttBDT --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc
#=====copy files with new categories=====
cp $PlotPath/BDTs/em/em_minmax.txt $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/data/mva_configs/em_expressions.cfg
cp ./em_mvadatacards.cfg $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/data/mva_configs/em_mvadatacards.cfg

python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py --mva -i $ArtusInput -a '--legend 0.23 0.63 0.9 0.83 --formats png eps pdf --y-rel-lims 0.9 1.75 --y-subplot-lims 0.5 1.5 --x-bins "40,-1,1" --filename "ratio_em_TwoJets_FakeBDT"' -s ztt zll ttj vv wj qcd ggh qqh vh htt data -m $Masses  -r --blinding-threshold 0.2 -c em -w $Weights --scale-signal 250 -o $PlotPath/BDTs/em/em_TwoJets_FakeBDT -n $Paralells -x em_TwoJets_FakeBDT --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc
python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py --mva -i $ArtusInput -a '--legend 0.23 0.63 0.9 0.83 --formats png eps pdf --y-rel-lims 0.9 1.75 --x-bins "400,-1,1" --filename "integral_em_TwoJets_FakeBDT" --sob-frontname "regular_name : "' -s ztt zll ttj vv wj qcd ggh qqh vh htt -m $Masses  --integrated-sob --integration-directions 'righttoleft' 'righttoleft' 'righttoleft' 'rcombination' --integration-methods soversqrtsplusb --integration-output $PlotPath/BDTs/em/em_minmax.txt -c em -w $Weights --blinding-threshold 0.15 --scale-signal 250 -o $PlotPath/BDTs/em/em_TwoJets_FakeBDT -n $Paralells -x em_TwoJets_FakeBDT --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc
#=====copy files with new categories=====
cp $PlotPath/BDTs/em/em_minmax.txt $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/data/mva_configs/em_expressions.cfg
cp ./em_mvadatacards.cfg $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/data/mva_configs/em_mvadatacards.cfg

python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py --mva -i $ArtusInput -a '--legend 0.23 0.63 0.9 0.83 --formats png eps pdf --y-rel-lims 0.9 1.75 --y-subplot-lims 0.5 1.5 --x-bins "40,-1,1" --filename "ratio_em_TwoJets_FinalBDT"' -s ztt zll ttj vv wj qcd ggh qqh vh htt data -m $Masses  -r --blinding-threshold 0.2 -c em -w $Weights --scale-signal 250 -o $PlotPath/BDTs/em/em_TwoJets_FinalBDT -n $Paralells -x em_TwoJets_FinalBDT --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc
python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py --mva -i $ArtusInput -a '--legend 0.23 0.63 0.9 0.83 --formats png eps pdf --y-rel-lims 0.9 1.75 --x-bins "400,-1,1" --filename "integral_em_TwoJets_FinalBDT" --sob-frontname "regular_name : "' -s ztt zll ttj vv wj qcd ggh qqh vh htt -m $Masses  --integrated-sob --integration-directions 'righttoleft' 'righttoleft' 'righttoleft' 'rcombination' --integration-methods soversqrtsplusb --integration-output $PlotPath/BDTs/em/em_minmax.txt -c em -w $Weights --blinding-threshold 0.15 --scale-signal 250 -o $PlotPath/BDTs/em/em_TwoJets_FinalBDT -n $Paralells -x em_TwoJets_FinalBDT --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc
#=====copy files with new categories=====
cp $PlotPath/BDTs/em/em_minmax.txt $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/data/mva_configs/em_expressions.cfg
cp ./em_mvadatacards.cfg $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/data/mva_configs/em_mvadatacards.cfg

python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py --mva -i $ArtusInput -a '--legend 0.23 0.63 0.9 0.83 --formats png eps pdf --y-rel-lims 0.9 1.75 --y-subplot-lims 0.5 1.5 --x-bins "40,-1,1" --filename "ratio_em_TwoJets_ZttBDT"' -s ztt zll ttj vv wj qcd ggh qqh vh htt data -m $Masses  -r --blinding-threshold 0.2 -c em -w $Weights --scale-signal 250 -o $PlotPath/BDTs/em/em_TwoJets_ZttBDT -n $Paralells -x em_TwoJets_ZttBDT --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc
python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py --mva -i $ArtusInput -a '--legend 0.23 0.63 0.9 0.83 --formats png eps pdf --y-rel-lims 0.9 1.75 --x-bins "400,-1,1" --filename "integral_em_TwoJets_ZttBDT" --sob-frontname "regular_name : "' -s ztt zll ttj vv wj qcd ggh qqh vh htt -m $Masses  --integrated-sob --integration-directions 'righttoleft' 'righttoleft' 'righttoleft' 'rcombination' --integration-methods soversqrtsplusb --integration-output $PlotPath/BDTs/em/em_minmax.txt -c em -w $Weights --blinding-threshold 0.15 --scale-signal 250 -o $PlotPath/BDTs/em/em_TwoJets_ZttBDT -n $Paralells -x em_TwoJets_ZttBDT --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc
#=====copy files with new categories=====
cp $PlotPath/BDTs/em/em_minmax.txt $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/data/mva_configs/em_expressions.cfg
cp ./em_mvadatacards.cfg $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/data/mva_configs/em_mvadatacards.cfg

python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py --mva -i $ArtusInput -a '--legend 0.23 0.63 0.9 0.83 --formats png eps pdf --y-rel-lims 0.9 1.75 --y-subplot-lims 0.5 1.5 --x-bins "40,-1,1" --filename "ratio_em_ZeroJets_FakeBDT"' -s ztt zll ttj vv wj qcd ggh qqh vh htt data -m $Masses  -r --blinding-threshold 0.2 -c em -w $Weights --scale-signal 250 -o $PlotPath/BDTs/em/em_ZeroJets_FakeBDT -n $Paralells -x em_ZeroJets_FakeBDT --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc
python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py --mva -i $ArtusInput -a '--legend 0.23 0.63 0.9 0.83 --formats png eps pdf --y-rel-lims 0.9 1.75 --x-bins "400,-1,1" --filename "integral_em_ZeroJets_FakeBDT" --sob-frontname "regular_name : "' -s ztt zll ttj vv wj qcd ggh qqh vh htt -m $Masses  --integrated-sob --integration-directions 'righttoleft' 'righttoleft' 'righttoleft' 'rcombination' --integration-methods soversqrtsplusb --integration-output $PlotPath/BDTs/em/em_minmax.txt -c em -w $Weights --blinding-threshold 0.15 --scale-signal 250 -o $PlotPath/BDTs/em/em_ZeroJets_FakeBDT -n $Paralells -x em_ZeroJets_FakeBDT --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc
#=====copy files with new categories=====
cp $PlotPath/BDTs/em/em_minmax.txt $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/data/mva_configs/em_expressions.cfg
cp ./em_mvadatacards.cfg $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/data/mva_configs/em_mvadatacards.cfg

python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py --mva -i $ArtusInput -a '--legend 0.23 0.63 0.9 0.83 --formats png eps pdf --y-rel-lims 0.9 1.75 --y-subplot-lims 0.5 1.5 --x-bins "40,-1,1" --filename "ratio_em_ZeroJets_FinalBDT"' -s ztt zll ttj vv wj qcd ggh qqh vh htt data -m $Masses  -r --blinding-threshold 0.2 -c em -w $Weights --scale-signal 250 -o $PlotPath/BDTs/em/em_ZeroJets_FinalBDT -n $Paralells -x em_ZeroJets_FinalBDT --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc
python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py --mva -i $ArtusInput -a '--legend 0.23 0.63 0.9 0.83 --formats png eps pdf --y-rel-lims 0.9 1.75 --x-bins "400,-1,1" --filename "integral_em_ZeroJets_FinalBDT" --sob-frontname "regular_name : "' -s ztt zll ttj vv wj qcd ggh qqh vh htt -m $Masses  --integrated-sob --integration-directions 'righttoleft' 'righttoleft' 'righttoleft' 'rcombination' --integration-methods soversqrtsplusb --integration-output $PlotPath/BDTs/em/em_minmax.txt -c em -w $Weights --blinding-threshold 0.15 --scale-signal 250 -o $PlotPath/BDTs/em/em_ZeroJets_FinalBDT -n $Paralells -x em_ZeroJets_FinalBDT --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc
#=====copy files with new categories=====
cp $PlotPath/BDTs/em/em_minmax.txt $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/data/mva_configs/em_expressions.cfg
cp ./em_mvadatacards.cfg $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/data/mva_configs/em_mvadatacards.cfg

python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py --mva -i $ArtusInput -a '--legend 0.23 0.63 0.9 0.83 --formats png eps pdf --y-rel-lims 0.9 1.75 --y-subplot-lims 0.5 1.5 --x-bins "40,-1,1" --filename "ratio_em_ZeroJets_ZttBDT"' -s ztt zll ttj vv wj qcd ggh qqh vh htt data -m $Masses  -r --blinding-threshold 0.2 -c em -w $Weights --scale-signal 250 -o $PlotPath/BDTs/em/em_ZeroJets_ZttBDT -n $Paralells -x em_ZeroJets_ZttBDT --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc
python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py --mva -i $ArtusInput -a '--legend 0.23 0.63 0.9 0.83 --formats png eps pdf --y-rel-lims 0.9 1.75 --x-bins "400,-1,1" --filename "integral_em_ZeroJets_ZttBDT" --sob-frontname "regular_name : "' -s ztt zll ttj vv wj qcd ggh qqh vh htt -m $Masses  --integrated-sob --integration-directions 'righttoleft' 'righttoleft' 'righttoleft' 'rcombination' --integration-methods soversqrtsplusb --integration-output $PlotPath/BDTs/em/em_minmax.txt -c em -w $Weights --blinding-threshold 0.15 --scale-signal 250 -o $PlotPath/BDTs/em/em_ZeroJets_ZttBDT -n $Paralells -x em_ZeroJets_ZttBDT --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc
#=====copy files with new categories=====
cp $PlotPath/BDTs/em/em_minmax.txt $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/data/mva_configs/em_expressions.cfg
cp ./em_mvadatacards.cfg $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/data/mva_configs/em_mvadatacards.cfg



#=====copy files with new categories=====
cp $PlotPath/BDTs/em/em_minmax.txt $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/data/mva_configs/em_expressions.cfg
cp ./em_mvadatacards.cfg $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/data/mva_configs/em_mvadatacards.cfg


#=====Controllplots and other stuff=====

python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py -r --mva -i $ArtusInput -a '--legend 0.23 0.63 0.9 0.83 --formats png eps pdf --y-rel-lims 0.9 1.75 --y-subplot-lims 0.5 1.5' -s ztt zll ttj vv wj qcd ggh qqh vh htt data -m $Masses -c em -w $Weights --scale-signal 250 -o $PlotPath/Controllplots/em -n $Paralells --blinding-threshold 0.2 --categories em_em_OneJets_FakeBDT_signal em_em_OneJets_FakeBDT_bkg em_em_OneJets_FakeBDT_mixed em_em_OneJets_FinalBDT_signal em_em_OneJets_FinalBDT_bkg em_em_OneJets_FinalBDT_mixed em_em_OneJets_ZttBDT_signal em_em_OneJets_ZttBDT_bkg em_em_OneJets_ZttBDT_mixed em_em_TwoJets_FakeBDT_signal em_em_TwoJets_FakeBDT_bkg em_em_TwoJets_FakeBDT_mixed em_em_TwoJets_FinalBDT_signal em_em_TwoJets_FinalBDT_bkg em_em_TwoJets_FinalBDT_mixed em_em_TwoJets_ZttBDT_signal em_em_TwoJets_ZttBDT_bkg em_em_TwoJets_ZttBDT_mixed em_em_ZeroJets_FakeBDT_signal em_em_ZeroJets_FakeBDT_bkg em_em_ZeroJets_FakeBDT_mixed em_em_ZeroJets_FinalBDT_signal em_em_ZeroJets_FinalBDT_bkg em_em_ZeroJets_FinalBDT_mixed em_em_ZeroJets_ZttBDT_signal em_em_ZeroJets_ZttBDT_bkg em_em_ZeroJets_ZttBDT_mixed em_inclusive -x pt_1 pt_2 H_pt mt_1 mt_2 pZetaMissVis mvamet diLepDeltaR diLepJet1DeltaR m_sv diLep_diJet_deltaR mjj jdeta m_sv m_vis --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc
python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py -r --mva -i $ArtusInput -a '--legend 0.23 0.63 0.9 0.83 --formats png eps pdf --y-rel-lims 0.9 1.75 --y-subplot-lims 0.5 1.5' -s ztt zll ttj vv wj qcd ggh qqh vh htt data -m $Masses -c em -w $Weights --scale-signal 25 -o $PlotPath/Controllplots/em -n $Paralells --blinding-threshold 0.2 --categories  -x pt_1 pt_2 H_pt mt_1 mt_2 pZetaMissVis mvamet diLepDeltaR diLepJet1DeltaR m_sv diLep_diJet_deltaR mjj jdeta m_sv m_vis --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc
python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py -r --mva -i $ArtusInput -a '--legend 0.23 0.63 0.9 0.83 --formats png eps pdf --y-rel-lims 0.9 1.75 --y-subplot-lims 0.5 1.5' -s ztt zll ttj vv wj qcd ggh qqh vh htt data -m $Masses -c em -w $Weights --scale-signal 250 -o $PlotPath/Controllplots/em -n $Paralells --blinding-threshold 0.2 --categories  -x pt_1 pt_2 H_pt mt_1 mt_2 pZetaMissVis mvamet diLepDeltaR diLepJet1DeltaR m_sv diLep_diJet_deltaR mjj jdeta m_sv m_vis --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc
python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py -r --mva -i $ArtusInput -a '--legend 0.23 0.63 0.9 0.83 --formats png eps pdf --y-rel-lims 0.9 1.75 --y-subplot-lims 0.5 1.5' -s ztt zll ttj vv wj qcd ggh qqh vh htt data -m $Masses -c em -w $Weights --scale-signal 25 -o $PlotPath/Controllplots/em -n $Paralells --blinding-threshold 0.2 --categories  -x pt_1 pt_2 H_pt mt_1 mt_2 pZetaMissVis mvamet diLepDeltaR diLepJet1DeltaR m_sv diLep_diJet_deltaR mjj jdeta m_sv m_vis --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc
python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py -r --mva -i $ArtusInput -a '--legend 0.23 0.63 0.9 0.83 --formats png eps pdf --y-rel-lims 0.9 1.75 --y-subplot-lims 0.5 1.5' -s ztt zll ttj vv wj qcd ggh qqh vh htt data -m $Masses -c em -w $Weights --scale-signal 250 -o $PlotPath/Controllplots/em -n $Paralells --blinding-threshold 0.2 --categories em_em_OneJets_FakeBDT_signal em_em_OneJets_FakeBDT_bkg em_em_OneJets_FakeBDT_mixed em_em_OneJets_FinalBDT_signal em_em_OneJets_FinalBDT_bkg em_em_OneJets_FinalBDT_mixed em_em_OneJets_ZttBDT_signal em_em_OneJets_ZttBDT_bkg em_em_OneJets_ZttBDT_mixed em_em_TwoJets_FakeBDT_signal em_em_TwoJets_FakeBDT_bkg em_em_TwoJets_FakeBDT_mixed em_em_TwoJets_FinalBDT_signal em_em_TwoJets_FinalBDT_bkg em_em_TwoJets_FinalBDT_mixed em_em_TwoJets_ZttBDT_signal em_em_TwoJets_ZttBDT_bkg em_em_TwoJets_ZttBDT_mixed em_em_ZeroJets_FakeBDT_signal em_em_ZeroJets_FakeBDT_bkg em_em_ZeroJets_FakeBDT_mixed em_em_ZeroJets_FinalBDT_signal em_em_ZeroJets_FinalBDT_bkg em_em_ZeroJets_FinalBDT_mixed em_em_ZeroJets_ZttBDT_signal em_em_ZeroJets_ZttBDT_bkg em_em_ZeroJets_ZttBDT_mixed em_inclusive -x pt_1 pt_2 H_pt mt_1 mt_2 pZetaMissVis mvamet diLepDeltaR diLepJet1DeltaR m_sv diLep_diJet_deltaR mjj jdeta m_sv m_vis --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc
python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py -r --mva -i $ArtusInput -a '--legend 0.23 0.63 0.9 0.83 --formats png eps pdf --y-rel-lims 0.9 1.75 --y-subplot-lims 0.5 1.5' -s ztt zll ttj vv wj qcd ggh qqh vh htt data -m $Masses -c em -w $Weights --scale-signal 25 -o $PlotPath/Controllplots/em -n $Paralells --blinding-threshold 0.2 --categories  -x pt_1 pt_2 H_pt mt_1 mt_2 pZetaMissVis mvamet diLepDeltaR diLepJet1DeltaR m_sv diLep_diJet_deltaR mjj jdeta m_sv m_vis --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc


#=====BDT Overtraining=====

python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/plot_overtraining.py -i ./* -o $PlotPath/BDTs/em -n $Paralells
python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/plot_overtraining.py -i ./* -o $PlotPath/BDTs/em -n $Paralells
python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/plot_overtraining.py -i ./* -o $PlotPath/BDTs/em -n $Paralells
python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/plot_overtraining.py -i ./* -o $PlotPath/BDTs/em -n $Paralells
python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/plot_overtraining.py -i ./* -o $PlotPath/BDTs/em -n $Paralells
python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/plot_overtraining.py -i ./* -o $PlotPath/BDTs/em -n $Paralells
python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/plot_overtraining.py -i ./* -o $PlotPath/BDTs/em -n $Paralells
python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/plot_overtraining.py -i ./* -o $PlotPath/BDTs/em -n $Paralells
python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/plot_overtraining.py -i ./* -o $PlotPath/BDTs/em -n $Paralells

python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py --mva -s ztt zll vv wj ttj qcd data htt -c em -w $Weights -m $Masses -i $ArtusInput -a '--plot-modules "PlotRootHtt" --x-bins "50,-1,1" --x-label "#scale[1.1]{(#sum((T(i)-Fin)/1)^{2})^{0.5}}" --formats eps png pdf --filename "sqrt_diff" --y-subplot-lims 0 2' -o $PlotPath/BDTs/em/em_OneJets_FakeBDT -r -x 'sqrt(((T1em_OneJets_FakeBDT-em_OneJets_FakeBDT)/1)+((T2em_OneJets_FakeBDT-em_OneJets_FakeBDT)/1))' --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc
python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py --mva -s ztt zll vv wj ttj qcd data htt -c em -w $Weights -m $Masses -i $ArtusInput -a '--plot-modules "PlotRootHtt" --x-bins "50,-1,1" --x-label "#scale[1.1]{(#sum((T(i)-Fin)/1)^{2})^{0.5}}" --formats eps png pdf --filename "sqrt_diff" --y-subplot-lims 0 2' -o $PlotPath/BDTs/em/em_OneJets_FinalBDT -r -x 'sqrt(((T1em_OneJets_FinalBDT-em_OneJets_FinalBDT)/1)+((T2em_OneJets_FinalBDT-em_OneJets_FinalBDT)/1))' --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc
python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py --mva -s ztt zll vv wj ttj qcd data htt -c em -w $Weights -m $Masses -i $ArtusInput -a '--plot-modules "PlotRootHtt" --x-bins "50,-1,1" --x-label "#scale[1.1]{(#sum((T(i)-Fin)/1)^{2})^{0.5}}" --formats eps png pdf --filename "sqrt_diff" --y-subplot-lims 0 2' -o $PlotPath/BDTs/em/em_OneJets_ZttBDT -r -x 'sqrt(((T1em_OneJets_ZttBDT-em_OneJets_ZttBDT)/1)+((T2em_OneJets_ZttBDT-em_OneJets_ZttBDT)/1))' --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc
python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py --mva -s ztt zll vv wj ttj qcd data htt -c em -w $Weights -m $Masses -i $ArtusInput -a '--plot-modules "PlotRootHtt" --x-bins "50,-1,1" --x-label "#scale[1.1]{(#sum((T(i)-Fin)/1)^{2})^{0.5}}" --formats eps png pdf --filename "sqrt_diff" --y-subplot-lims 0 2' -o $PlotPath/BDTs/em/em_TwoJets_FakeBDT -r -x 'sqrt(((T1em_TwoJets_FakeBDT-em_TwoJets_FakeBDT)/1)+((T2em_TwoJets_FakeBDT-em_TwoJets_FakeBDT)/1))' --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc
python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py --mva -s ztt zll vv wj ttj qcd data htt -c em -w $Weights -m $Masses -i $ArtusInput -a '--plot-modules "PlotRootHtt" --x-bins "50,-1,1" --x-label "#scale[1.1]{(#sum((T(i)-Fin)/1)^{2})^{0.5}}" --formats eps png pdf --filename "sqrt_diff" --y-subplot-lims 0 2' -o $PlotPath/BDTs/em/em_TwoJets_FinalBDT -r -x 'sqrt(((T1em_TwoJets_FinalBDT-em_TwoJets_FinalBDT)/1)+((T2em_TwoJets_FinalBDT-em_TwoJets_FinalBDT)/1))' --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc
python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py --mva -s ztt zll vv wj ttj qcd data htt -c em -w $Weights -m $Masses -i $ArtusInput -a '--plot-modules "PlotRootHtt" --x-bins "50,-1,1" --x-label "#scale[1.1]{(#sum((T(i)-Fin)/1)^{2})^{0.5}}" --formats eps png pdf --filename "sqrt_diff" --y-subplot-lims 0 2' -o $PlotPath/BDTs/em/em_TwoJets_ZttBDT -r -x 'sqrt(((T1em_TwoJets_ZttBDT-em_TwoJets_ZttBDT)/1)+((T2em_TwoJets_ZttBDT-em_TwoJets_ZttBDT)/1))' --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc
python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py --mva -s ztt zll vv wj ttj qcd data htt -c em -w $Weights -m $Masses -i $ArtusInput -a '--plot-modules "PlotRootHtt" --x-bins "50,-1,1" --x-label "#scale[1.1]{(#sum((T(i)-Fin)/1)^{2})^{0.5}}" --formats eps png pdf --filename "sqrt_diff" --y-subplot-lims 0 2' -o $PlotPath/BDTs/em/em_ZeroJets_FakeBDT -r -x 'sqrt(((T1em_ZeroJets_FakeBDT-em_ZeroJets_FakeBDT)/1)+((T2em_ZeroJets_FakeBDT-em_ZeroJets_FakeBDT)/1))' --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc
python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py --mva -s ztt zll vv wj ttj qcd data htt -c em -w $Weights -m $Masses -i $ArtusInput -a '--plot-modules "PlotRootHtt" --x-bins "50,-1,1" --x-label "#scale[1.1]{(#sum((T(i)-Fin)/1)^{2})^{0.5}}" --formats eps png pdf --filename "sqrt_diff" --y-subplot-lims 0 2' -o $PlotPath/BDTs/em/em_ZeroJets_FinalBDT -r -x 'sqrt(((T1em_ZeroJets_FinalBDT-em_ZeroJets_FinalBDT)/1)+((T2em_ZeroJets_FinalBDT-em_ZeroJets_FinalBDT)/1))' --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc
python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_controlPlots.py --mva -s ztt zll vv wj ttj qcd data htt -c em -w $Weights -m $Masses -i $ArtusInput -a '--plot-modules "PlotRootHtt" --x-bins "50,-1,1" --x-label "#scale[1.1]{(#sum((T(i)-Fin)/1)^{2})^{0.5}}" --formats eps png pdf --filename "sqrt_diff" --y-subplot-lims 0 2' -o $PlotPath/BDTs/em/em_ZeroJets_ZttBDT -r -x 'sqrt(((T1em_ZeroJets_ZttBDT-em_ZeroJets_ZttBDT)/1)+((T2em_ZeroJets_ZttBDT-em_ZeroJets_ZttBDT)/1))' --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc
python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/nFold_DiffScan.py -i $PlotPath/BDTs/em -o $PlotPath/em_DiffScans -m $Masses

#=====Categorization Overlap=====



#=====Limit commands start here=====

python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/makePlots_datacardsMVATest.py -i $ArtusInput -x $Variable --add-bbb-uncs -m $Masses -n $Paralells --clear-output-dir -c em -w $Weights -o $PlotPath/em/classic --categories 0jet_high 0jet_low 1jet_high 1jet_low 2jet_vbf --scale-mc-only $scale_mc --project-to-lumi $project_lumi --cut-mc-only $cut_mc


python $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/scripts/limit_collector.py -i $PlotPath/em/classic -o $PlotPath/limits_vbftagging -m $Masses


#=====remove files with new categories=====

rm $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/data/mva_configs/em_expressions.cfg
rm $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/data/mva_configs/em_mvadatacards.cfg
rm $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/data/mva_configs/Reg_BDT.cfg
rm $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/data/mva_configs/VBF_BDT.cfg
rm $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/data/mva_configs/em_shift_expressions.cfg
touch $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/data/mva_configs/em_expressions.cfg
touch $CMSSW_BASE/src/HiggsAnalysis/KITHiggsToTauTau/data/mva_configs/em_mvadatacards.cfg
